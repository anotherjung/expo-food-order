# Order

create orders and order_items tables in Superbase

add policy to both tables, auth users all operations true true

create new order and order_items

## Orders API READ

npx supabase gen types typescript --project-id mlhuqnftpthkvwvcwiqk > database.types.ts
- generates new tables, orders, order_items
- export const useAdminOrderList = () => { 
- admins will see all orders

mkdir api/orders && touch api/orders/index.ts

## Orders Admin

api/orders/index.ts
- export const useAdminOrderList = () => {

app/(admin)/order/index.tsx
- import { useAdminOrderList } from '@/api/orders';
- const { data: orders, error } = useAdminOrderList();
- delete static test data

## Orders My User id

api/orders/index.ts
- export const useMyOrderList = () => {
- const { session } = useAuth();
- const id = session?.user.id;
- return useQuery({ queryKey: ['orders', { userId: id }],

app/(user)/order/index.tsx
- import { useMyOrderList } from '@/api/orders';
- const { data: orders, isLoading, error } = useMyOrderList();
- delete static test data

components/OrderListItem.tsx
- import { Order, Tables } from "@/types";
- type OrderListItemProps = { order: Tables<'orders'>;

## Order id READ

api/orders/index.ts
- export const useOrderDetails = (id: number) => {

app/(user)/order/[id].tsx
- import { useOrderDetails } from '@/api/orders';
- const { id: idString } = useLocalSearchParams();
- const id = parseFloat(typeof idString === 'string' ? idString : idString[0]);
- const { data: order, isLoading, error } = useOrderDetails(id);

app/(admin)/order/[id].tsx
- import { useOrderDetails } from '@/api/orders';
- const { id: idString } = useLocalSearchParams();
- const id = parseFloat(typeof idString === 'string' ? idString : idString[0]);
- const { data: order, isLoading, error } = useOrderDetails(id);